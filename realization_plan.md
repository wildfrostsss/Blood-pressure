# План реализации PWA "Дневник давления"

## Этап 1: Инициализация проекта и базовая структура

- [x] **Задача 1.1:** Создать базовую структуру файлов и папок.
    - `index.html`: Основной HTML-файл.
    - `style.css`: Основной файл стилей.
    - `script.js`: Основной файл JavaScript.
    - `manifest.json`: Манифест веб-приложения.
    - `sw.js`: Service Worker.
    - `assets/`: Папка для иконок и других ресурсов.
        - `icons/`: Папка для иконок приложения разных размеров.

## Этап 2: Основной интерфейс и ввод данных

- [x] **Задача 2.1:** Создать HTML-разметку для главного экрана в `index.html`.
    - Заголовок приложения.
    - Форма для ввода данных: систолическое давление, диастолическое давление, пульс.
    - Поле для выбора даты и времени измерения.
    - Кнопка "Сохранить".
    - Контейнер для отображения списка измерений за выбранный день.
- [x] **Задача 2.2:** Реализовать базовую стилизацию в `style.css`.
    - Стили для основных элементов: body, контейнеры, форма, поля ввода, кнопки.
    - Настройка переменных для светлой и темной тем.
- [x] **Задача 2.3:** Реализовать логику сохранения данных в `script.js`.
    - Написать функцию для сохранения нового измерения в `localStorage`.
    - Написать функцию для чтения измерений из `localStorage` за определенную дату.
    - Добавить обработчик события на кнопку "Сохранить".
    - Реализовать отображение сохраненных измерений на странице.

## Этап 3: Просмотр истории и календарь

- [x] **Задача 3.1:** Интегрировать или создать компонент календаря.
    - Добавить HTML-разметку для календаря.
    - Стилизовать календарь.
    - Реализовать логику для отображения дней, в которые были измерения.
    - Добавить обработчик события для выбора даты в календаре и отображения соответствующих измерений.

## Этап 4: Визуализация данных (Графики)

- [x] **Задача 4.1:** Интегрировать библиотеку для построения графиков (например, Chart.js).
    - Подключить библиотеку к проекту.
- [x] **Задача 4.2:** Создать интерфейс для раздела с графиками.
    - Добавить переключатели для выбора диапазона дат (неделя, месяц, произвольный).
    - Добавить `canvas` для отображения графика.
- [x] **Задача 4.3:** Реализовать логику построения графиков.
    - Написать функцию для подготовки данных для графика на основе выбранного диапазона.
    - Написать функцию для отрисовки/обновления графика.

## Этап 5: Генерация PDF-отчетов

- [x] **Задача 5.1:** Интегрировать библиотеки для генерации PDF (например, jsPDF, html2canvas).
    - Подключить библиотеки к проекту.
- [x] **Задача 5.2:** Реализовать функцию генерации отчета.
    - Создать скрытый HTML-шаблон для отчета (таблица + график).
    - Написать функцию, которая заполняет шаблон данными за выбранный период.
    - Написать функцию, которая конвертирует HTML-шаблон в PDF и предлагает его для скачивания.

## Этап 6: Реализация PWA

- [x] **Задача 6.1:** Настроить `manifest.json`.
    - Заполнить поля: `name`, `short_name`, `start_url`, `display`, `background_color`, `theme_color`, `icons`.
- [x] **Задача 6.2:** Подготовить иконки приложения.
    - Создать иконки разных размеров (например, 192x192, 512x512) и поместить их в `assets/icons/`.
- [x] **Задача 6.3:** Написать логику Service Worker в `sw.js`.
    - Реализовать кэширование основных ресурсов приложения (`install` event).
    - Реализовать стратегию кэширования (например, Cache First) для офлайн-доступа (`fetch` event).
- [x] **Задача 6.4:** Зарегистрировать Service Worker в `script.js`.

## Этап 7: Финальные штрихи и документация

- [x] **Задача 7.1:** Реализовать переключение тем (светлая/темная).
    - Добавить переключатель в интерфейс.
    - Написать JS-логику для смены темы и сохранения выбора в `localStorage`.
- [x] **Задача 7.2:** Написать инструкцию по тестированию (`TESTING.md`).
- [x] **Задача 7.3:** Написать инструкцию по развертыванию на GitHub Pages (`DEPLOY.md`).

## Этап 8: Доработки

- [x] **Задача 8.1:** Добавить функцию удаления измерений.
    - В каждый элемент списка измерений добавить кнопку "Удалить".
    - Реализовать JS-логику для удаления записи из `localStorage` по уникальному идентификатору.
    - После удаления обновлять список измерений, календарь и график.
    - Добавить стили для кнопки удаления.

## Этап 9: Адаптация под мобильные устройства и редизайн интерфейса

- [x] **Задача 9.1:** Переработать главный экран приложения.
    - Создать новый главный экран с 4 квадратными плитками навигации.
    - Добавить заголовок "Дневник давления" с кнопкой переключения темы справа.
    - Реализовать плитки: "Добавить измерение", "Календарь измерений", "Графики", "Сгенерировать отчет".
    - Скрыть существующие секции по умолчанию и показывать их при клике на соответствующие плитки.
    - Добавить кнопки "Назад" для возврата на главный экран.

- [x] **Задача 9.2:** Адаптировать интерфейс под экраны 6.67" (соотношение 20:9).
    - Оптимизировать размеры и расположение плиток для экранов 6.67".
    - Обеспечить адаптивность для различных размеров мобильных экранов.
    - Настроить корректное отображение элементов на узких экранах.

- [x] **Задача 9.3:** Реализовать навигацию между секциями.
    - Добавить функционал для показа/скрытия секций при клике на плитки.
    - Реализовать возврат на главный экран через кнопки "Назад".
    - Обеспечить корректную работу всех существующих функций в новом интерфейсе.

- [x] **Задача 9.4:** Улучшить визуализацию графиков.
    - Выделить отметки 120 и 80 на графике более выразительными линиями и цветом.
    - Увеличить толщину линий для отметок 120 (красный) и 80 (синий).
    - Добавить визуальные индикаторы для этих значений.

- [x] **Задача 9.5:** Исправить навигацию между секциями.
    - Исправить функцию initNavigation() для корректной обработки кликов на плитки.
    - Добавить дополнительную инициализацию для каждой секции при открытии.
    - Обеспечить корректное обновление календаря и графиков при переключении.
    - Исправить функцию selectDate() для показа секции measurements-list при выборе даты.

- [x] **Задача 9.7:** Финальное исправление навигации и добавление выбора периода для отчета.
    - Исправлена функция showSection() для корректного показа/скрытия секций.
    - Исправлена функция initNavigation() для корректной обработки кликов на плитки.
    - Добавлена возможность выбора периода для генерации отчета.
    - Исправлена синтаксическая ошибка в строке 562.

- [x] **Задача 9.6:** Настроить автоматическое развертывание на GitHub Pages.
    - Создать директорию .github/workflows.
    - Создать файл .github/workflows/deploy.yml с конфигурацией для автоматического развертывания.
    - Обновить файл DEPLOY.md с информацией о настроенном автоматическом развертывании.

- [x] **Задача 9.5:** Исправить навигацию между секциями.
    - Исправить функцию initNavigation() для корректной обработки кликов на плитки.
    - Убедиться, что при клике на плитку "Календарь измерений" показывается секция calendar-container.
    - Убедиться, что при клике на плитку "Графики" показывается секция charts-container.
    - Проверить, что все плитки работают корректно.

## Этап 10: Развертывание на GitHub

- [x] **Задача 10.1:** Загрузить изменения на GitHub.
    - Инициализировать Git репозиторий.
    - Добавить все файлы проекта в индекс.
    - Создать коммит с описанием изменений.
    - Отправить изменения на удаленный репозиторий GitHub.

- [x] **Задача 10.2:** Исправить проблему с иконками приложения.
    - Исправлены пути к иконкам в manifest.json.
    - Исправлены пути к ресурсам в index.html.
    - Исправлены пути в отладочных файлах.
    - Добавлены слэши в начале путей для корректной работы на GitHub Pages.
    - Загружены исправления на GitHub.