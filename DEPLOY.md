# Инструкция по развертыванию PWA "Дневник давления" на GitHub Pages

## Подготовка к развертыванию

### 1. Требования

- Аккаунт на GitHub
- Установленный Git на вашем компьютере
- Базовые знания работы с Git и GitHub

### 2. Проверка проекта

Перед развертыванием убедитесь, что:

1. Все файлы проекта находятся в корневой директории
2. Отсутствуют ошибки в JavaScript и CSS
3. Все пути к ресурсам относительные (не абсолютные)
4. Манифест `manifest.json` корректно настроен
5. Service Worker (`sw.js`) правильно настроен для работы с GitHub Pages

## Развертывание через GitHub Pages

### Способ 1: Через существующий репозиторий

Если у вас уже есть репозиторий с проектом:

1. **Убедитесь, что все изменения закоммичены:**
   ```bash
   git add .
   git commit -m "Добавлен функционал PWA для дневника давления"
   git push origin main
   ```

2. **Активируйте GitHub Pages:**
   - Перейдите в ваш репозиторий на GitHub
   - Нажмите на вкладку "Settings"
   - В меню слева выберите "Pages"
   - В разделе "Build and deployment" выберите источник "Deploy from a branch"
   - В качестве ветки выберите "main" (или "master") и папку "/ (root)"
   - Нажмите "Save"

3. **Дождитесь завершения развертывания:**
   - GitHub сообщит, когда сайт будет готов (обычно занимает несколько минут)
   - Сайт будет доступен по адресу: `https://[ваш-никнейм].github.io/[название-репозитория]`

### Способ 2: Создание нового репозитория

Если вы создаете новый репозиторий:

1. **Создайте репозиторий на GitHub:**
   - Войдите в свой аккаунт GitHub
   - Нажмите на "+" в правом верхнем углу и выберите "New repository"
   - Назовите репозиторий (например, "blood-pressure-app")
   - Выберите "Public" (для бесплатного использования GitHub Pages)
   - Не инициализируйте README, .gitignore и лицензию (если у вас уже есть файлы)
   - Нажмите "Create repository"

2. **Свяжите локальный проект с удаленным репозиторием:**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git branch -M main
   git remote add origin https://github.com/[ваш-никнейм]/[название-репозитория].git
   git push -u origin main
   ```

3. **Активируйте GitHub Pages** (как в способе 1)

## Настройка PWA для GitHub Pages

### 1. Обновление манифеста

Убедитесь, что в `manifest.json` правильно указан путь к стартовой странице:

```json
{
  "name": "Дневник давления",
  "short_name": "Давление",
  "start_url": "./",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#007bff",
  "icons": [
    {
      "src": "assets/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "assets/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

### 2. Настройка Service Worker

Убедитесь, что в `sw.js` правильно настроены пути для кэширования:

```javascript
const CACHE_NAME = 'blood-pressure-v1';
const urlsToCache = [
  '/',
  '/index.html',
  '/style.css',
  '/script.js',
  '/manifest.json',
  '/assets/icons/icon-192x192.png',
  '/assets/icons/icon-512x512.png'
];
```

## Проверка развертывания

### 1. Базовая проверка

1. Откройте ваш сайт в браузере
2. Проверьте, что все страницы загружаются корректно
3. Убедитесь, что все стили применяются правильно
4. Проверьте работу JavaScript-функционала

### 2. Проверка PWA

1. **Проверка манифеста:**
   - Откройте инструменты разработчика (F12)
   - Перейдите на вкладку "Application" (в Chrome) или "Storage" (в Firefox)
   - Выберите "Manifest"
   - Убедитесь, что манифест загружается и корректно отображается

2. **Проверка Service Worker:**
   - В тех же инструментах разработчика выберите "Service Workers"
   - Убедитесь, что Service Worker зарегистрирован и активен
   - Проверьте, что ресурсы кэшируются корректно

3. **Проверка установки:**
   - В браузере на базе Chromium (Chrome, Edge) должна появиться иконка установки
   - Попробуйте установить приложение и проверить его работу

### 3. Проверка офлайн-режима

1. Установите приложение
2. Отключитесь от интернета
3. Запустите приложение
4. Убедитесь, что основные функции работают в офлайн-режиме

## Возможные проблемы и решения

### 1. Страница не найдена (404)

**Проблема:** GitHub Pages возвращает 404 для некоторых путей.

**Решение:** Убедитесь, что все пути в вашем приложении относительные и начинаются с "./" или "/".

### 2. Service Worker не работает

**Проблема:** Service Worker не регистрируется или работает некорректно.

**Решение:** 
- Проверьте, что Service Worker обслуживается через HTTPS (GitHub Pages делает это автоматически)
- Убедитесь, что пути в Service Worker указаны правильно
- Проверьте консоль браузера на наличие ошибок

### 3. Иконки приложения не отображаются

**Проблема:** Иконки PWA не загружаются.

**Решение:**
- Убедитесь, что пути к иконкам в `manifest.json` указаны правильно
- Проверьте, что файлы иконок существуют в указанных местах
- Убедитесь, что иконки имеют правильный размер и формат

### 4. Приложение не устанавливается

**Проблема:** Кнопка установки PWA не появляется.

**Решение:**
- Проверьте корректность `manifest.json`
- Убедитесь, что Service Worker зарегистрирован и работает
- Проверьте, что сайт обслуживается по HTTPS
- Убедитесь, что в манифесте указаны иконки нужных размеров (минимум 192x192 и 512x512)

## Автоматическое развертывание (настроено)

### Настройка GitHub Actions

Для автоматического развертывания при каждом коммите в основную ветку уже настроен GitHub Actions:

1. Создан файл `.github/workflows/deploy.yml` со следующим содержимым:

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v3
      
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    - name: Build
      run: |
        echo "No build step required for static site"
        
    - name: Deploy
      uses: peaceiris/actions-gh-pages@v3
      if: github.ref == 'refs/heads/main'
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./
```

2. Файл уже добавлен в репозиторий и будет автоматически развертывать приложение при каждом коммите в основную ветку.

3. Для активации автоматического развертывания убедитесь, что в настройках репозитория (Settings > Pages) выбран источник "GitHub Actions"

### Как работает автоматическое развертывание

1. При каждом коммите в ветку `main` автоматически запускается процесс развертывания
2. GitHub Actions проверяет код, настраивает окружение Node.js
3. Поскольку это статический сайт, этап сборки пропускается
4. Код автоматически публикуется на GitHub Pages
5. Обычно процесс развертывания занимает 1-5 минут

### Преимущества автоматического развертывания

- Не нужно вручную обновлять сайт после каждого изменения
- Все изменения в основной ветке сразу появляются на сайте
- Сохраняется история развертываний
- Можно откатиться к предыдущей версии при необходимости

## Обновление приложения

Для обновления приложения на GitHub Pages:

1. Внесите необходимые изменения в локальные файлы
2. Закоммитьте изменения:
   ```bash
   git add .
   git commit -m "Описание изменений"
   ```
3. Отправьте изменения в репозиторий:
   ```bash
   git push origin main
   ```
4. Дождитесь завершения автоматического развертывания (обычно 1-5 минут)

## Заключение

После выполнения этих шагов ваше PWA "Дневник давления" будет доступно на GitHub Pages. Пользователи смогут получить к нему доступ через браузер, установить на устройство и использовать в офлайн-режиме.

Регулярно проверяйте работоспособность приложения после обновлений и следите за появлением ошибок в консоли браузера.